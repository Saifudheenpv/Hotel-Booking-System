<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse All Hotels - LuxStay</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <!-- Flash Messages -->
    <div th:if="${success}" class="flash-message">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    </div>
    <div th:if="${error}" class="flash-message">
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-hotel"></i> LuxStay
            </a>
            
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">Home</a>
                <a class="nav-link active" href="/hotels">Browse Hotels</a>
                
                <!-- User Session Management -->
                <div th:if="${session.user != null}">
                    <a class="nav-link" href="/my-bookings">My Bookings</a>
                    <span class="nav-link">Welcome, <span th:text="${session.user.firstName}"></span></span>
                    <a class="nav-link" href="/logout">Logout</a>
                </div>
                <div th:unless="${session.user != null}">
                    <a class="nav-link" href="/login">Login</a>
                    <a class="btn btn-outline-light ms-2" href="/register">Register</a>
                </div>
                
                <button id="themeToggle" class="btn btn-outline-light ms-3">
                    <i class="fas fa-moon"></i> Theme
                </button>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="container mt-5">
        <div class="page-header text-center mb-5">
            <h1 class="display-4 fw-bold text-primary">Browse All Hotels</h1>
            <p class="lead text-muted">Discover our complete collection of luxury accommodations worldwide</p>
        </div>

        <!-- Search Box -->
        <div class="search-box mb-4">
            <form action="/hotels" method="get" class="search-form">
                <div class="form-group">
                    <label class="form-label">Search hotels</label>
                    <input type="text" class="form-control" name="search" 
                           placeholder="Search by hotel name, location, or amenity..."
                           th:value="${searchQuery}">
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search"></i> Search
                </button>
            </form>
        </div>

        <!-- Filters -->
        <div class="filter-section">
            <h4 class="filter-title">Filter by Rating:</h4>
            <div class="filter-buttons">
                <a th:href="@{/hotels(minRating=4.5)}" class="filter-btn" th:classappend="${minRating == 4.5} ? 'active' : ''">
                    4.5+ Stars
                </a>
                <a th:href="@{/hotels(minRating=4.0)}" class="filter-btn" th:classappend="${minRating == 4.0} ? 'active' : ''">
                    4.0+ Stars
                </a>
                <a th:href="@{/hotels(minRating=3.5)}" class="filter-btn" th:classappend="${minRating == 3.5} ? 'active' : ''">
                    3.5+ Stars
                </a>
                <a th:href="@{/hotels}" class="filter-btn clear-btn">
                    Clear Filters
                </a>
            </div>
        </div>

        <!-- Results Info -->
        <div class="results-header">
            <h2 class="section-title">
                <span th:if="${searchQuery}" th:text="'Results for \'' + ${searchQuery} + '\''"></span>
                <span th:unless="${searchQuery}">All Hotels</span>
            </h2>
            <div class="results-count" th:text="${#lists.size(hotels)} + ' hotels found'"></div>
        </div>

        <!-- Hotels Grid -->
        <div class="hotel-grid">
            <div class="row">
                <div class="col-md-6 col-lg-4" th:each="hotel : ${hotels}">
                    <div class="hotel-card">
                        <img th:src="${hotel.imageUrl != null} ? ${hotel.imageUrl} : 'https://images.unsplash.com/photo-1564501049412-61c2a3083791?w=400&h=250&fit=crop'" 
                             class="hotel-image"
                             th:alt="${hotel.name}">
                        <div class="hotel-info">
                            <h3 class="hotel-name" th:text="${hotel.name}">Hotel Name</h3>
                            <p class="hotel-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <span th:text="${hotel.location}">Location</span>
                            </p>
                            <div class="rating">
                                <div class="stars">
                                    <i class="fas fa-star" th:each="i : ${#numbers.sequence(1,5)}"
                                       th:class="${i <= (hotel.rating != null ? hotel.rating : 0)} ? 'fas fa-star' : 'far fa-star'"></i>
                                </div>
                                <span class="rating-value" th:text="${hotel.rating != null} ? ${#numbers.formatDecimal(hotel.rating, 1, 1)} + '/5' : 'No rating'">4.5/5</span>
                            </div>
                            <p class="hotel-description" th:text="${hotel.description != null} ? ${hotel.description} : 'Luxury accommodation with premium amenities.'">
                                Hotel description
                            </p>
                            <div class="amenities" th:if="${hotel.amenities != null}">
                                <span th:each="amenity : ${#strings.arraySplit(hotel.amenities, ',')}"
                                      class="amenity-tag" th:text="${amenity}">Amenity</span>
                            </div>
                            <div class="price-section">
                                <span class="price" th:if="${hotel.startingPrice != null}" 
                                      th:text="'$' + ${#numbers.formatDecimal(hotel.startingPrice, 0, 0)} + '/night'">$250/night</span>
                                <span class="price" th:unless="${hotel.startingPrice != null}">
                                    Contact for price
                                </span>
                                <a th:href="@{/hotels/{id}/rooms(id=${hotel.id})}" class="btn btn-primary">
                                    Book Now
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- No Results -->
        <div th:if="${#lists.isEmpty(hotels)}" class="no-results">
            <i class="fas fa-search fa-3x mb-3"></i>
            <h3>No hotels found</h3>
            <p>Try adjusting your search criteria or filters</p>
            <a th:href="@{/hotels}" class="btn btn-primary">Show All Hotels</a>
        </div>

        <!-- Back to Home -->
        <div class="text-center mt-5">
            <a th:href="@{/}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left"></i> Back to Home
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center">
            <p class="mb-1">üè® LuxStay ‚Äî Premium Hotel Booking Experience</p>
            <p class="mb-0">
                <i class="fas fa-envelope"></i> support@luxstay.com | 
                <i class="fas fa-phone"></i> +1 (555) 123-4567
            </p>
            <p class="mt-2">&copy; 2024 LuxStay. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/app.js}"></script>
</body>
</html>